Throw me big challenges - Formulas & VBA
Mate, you have my 'axe'   
  
I'm a fucking wizard with formula and I'm no slouch with VBA.  
  
Also I'm a financial analyst so I have quite a bit of non excel relevant expertise... 
  
  
EDIT: My /r/excel "CV" *(Stuff I've done for people on the sub)*  
  
1. [Dynamic list of names with matching code](https://dl.dropboxusercontent.com/u/100748450/CosImAWizard.xlsx)  
2. [Monty Carlo with data table](https://dl.dropboxusercontent.com/u/100748450/Monte%20Carlo%20Analysis%20-%20Data%20Tables%20Extended.xlsx)  
3. [Top 5 Sales opportunities](https://dl.dropboxusercontent.com/u/100748450/Top%205%20Opportunities%20v2.xlsx)  
4. [Index/Match/Match example](https://dl.dropboxusercontent.com/u/100748450/121118%20-%20Index-Match-Match.xlsx)  
5. [Frequency of drug overlap](https://dl.dropboxusercontent.com/u/100748450/130131%20-%20Hope%20this%20helps.xlsx)  
6. [Sumproduct/Sumif comparison example](https://dl.dropboxusercontent.com/u/100748450/121118%20-%20Sumproduct%20%26%20Sumif.xlsx)  
7. [Lookup grades with multiple solutions](https://dl.dropboxusercontent.com/u/100748450/121116%20-%20Grades.xlsx)  
8. [Sumif using a range of criteria, this is SERIOUSLY cool and unreasonably efficient (Shut up about you're "sumifs" :•p)](https://dl.dropboxusercontent.com/u/100748450/130430%20-%20SUMIFS%20-%20Multiple%20criteria.xlsx)  
9. [Some kid wanted his homework done](https://dl.dropboxusercontent.com/u/100748450/130502%20-%20I%20DOES%20YOUR%20HOMEWORK%20TOO%20WELLS.xlsx)  
10. [Guy had an excel test for a job interview](https://dl.dropboxusercontent.com/u/100748450/130502%20-%20I%20came%2C%20I%20saw%2C%20I%20did%20your%20homework.xlsx)  
11. [Bad data fixed w pivot charts](https://dl.dropboxusercontent.com/u/100748450/NBC%20v%20keebler.xlsx)  
12. [Commercial Property Calculator](https://dl.dropboxusercontent.com/u/100748450/Commercial%20Property%20Calc.xlsx)  
13. [More homework](https://dl.dropboxusercontent.com/u/100748450/YourHomeworkSir.xlsx)  
14. [VBA to remove duplicates](https://dl.dropboxusercontent.com/u/100748450/130802%20-%20Remove%20duplicates.xlsm)  
15. [Alternating extreme pos-neg values from a random data set](https://dl.dropboxusercontent.com/u/100748450/130802%20-%20Like%20a%20BAWS.xlsx)  
16. [Take rightmost 3 vales, add them and then look up result - Much Abstraction](https://dl.dropboxusercontent.com/u/100748450/130810%20-%20Fucking%20Wizard.xlsx)  
17. [Possible chart types for some newb](https://dl.dropboxusercontent.com/u/100748450/130903%20-%20Chart%20types.xlsx)  
18. [Couple of Gantt chart options](https://dl.dropboxusercontent.com/u/100748450/140303%20-%20Gantt%20Chart.xlsx)  
19. [Conditonal formatting based on a start/finish cell AKA inefficient as fuck](https://dl.dropboxusercontent.com/u/100748450/140304%20-%20Highlight%20selection%20based%20on%20a%20start-finish.xlsx)  
20. [Fixed a hospitality managers abomination](https://dl.dropboxusercontent.com/u/100748450/140312%20-%20Conditionally%20add%20a%20p.xlsx)  
21. [Why do I keep doing homework](https://dl.dropboxusercontent.com/u/100748450/140318%20-%20Investment%20return%20and%20fees.xlsm)  
22. [Vendor Financing Calculator](https://dl.dropboxusercontent.com/u/100748450/130121%20-%20Vendor%20Finance%20Calculator.xlsx)  
23. [GetPivotData accepts arrays, look the fuck out](https://dl.dropboxusercontent.com/u/100748450/131211%20-%20Array%20input%20to%20GetPivotData.xlsx)  
24. [Some payroll calc craziness](https://dl.dropboxusercontent.com/u/100748450/131211%20-%20%20For%20Indie.xlsx)  
25. [Can't remember why in the what or the who](https://dl.dropboxusercontent.com/u/100748450/131004%20-%20Solution.xlsx)  
26. [Highest value for each date highlighted](https://dl.dropboxusercontent.com/u/100748450/131003%20-%20Highest%20Value%20for%20a%20date%20highlighted.xlsx)  
27. [Depreciation Calculator](https://dl.dropboxusercontent.com/u/100748450/130912%20-%20Depreciation%20Calc%20-%20Modified%20v2.xlsx)  
  
I didn't realise there was this much misc shit I had done... Just think how many times I could have rubbed one out!
Here's something to consider...  you're bored now?  Look at your job... step through your processes... make it so you can be bored YEAR ROUND!

I scribbled up a macro for a co-worker (took me about six hours, including revisions and debugging) and the first time he ran it, it saved him basically three day's worth of work... (lots of tedium).. and it can be applied elsewhere in the department.

Of course, keep in mind, doing this can cause your job to vanish... I've automated myself out of employment twice. :D
I'm up for helping out, unfortunately I don't really have any excel things I need help with. It would be cool to make a really bitchin' template for something, but especially for business requirements, I always feel like you're dealing with  
a) something that is so routine that there are great templates for it already or  
b) Something that is so ad-hoc that it's difficult to build a template for without being super-specific (like many of the questions we get on this board, e.g. the pipeline guy that comes by once in a while, I bet we could make a super amazing pipeline operational template/spreadsheet if we had the data, but most of their really business crucial needs are probably already satisfied by existing systems and it may require access to data that is too operationally sensitive to share on the internet) 

A few of the little projects I have had in mind for a while but haven't gotten started on are pretty boring and economics focused (so not terribly useful for 99% of the population), and in some cases superfluous. But I'll take the plunge and throw them out there:  

Ripping all the data from the horribly shitty [chinese statistics bureau](http://www.stats.gov.cn/english/) website and building a functional database,  which is just a boring data entry project, but that website of theirs just makes me feel antsy to do something about it. Ensuring that the data is updated as they revise their statistics would be a further problem. 

I have also been considering building a spreadsheet that uses the [Eurostat REST SDMX](http://epp.eurostat.ec.europa.eu/portal/page/portal/sdmx_web_services/about_eurostat_data)(Statistical Data and Metadata Exchange) for producing multiple european economic statistics in one "pull" and possible chart/graph/table them in various ways. The Eurostat website is quite good ([regional data graphical display](http://ec.europa.eu/eurostat/statistical-atlas/gis/viewer/) is pretty cool and their normal data viewer pretty useful for pulling individual data from individual databases), but when I was using it I always wanted to be able to pull a range of statistics for a country for a period and have it displayed like I wanted it to. This is pretty similar to what you can do with [FRED](http://research.stlouisfed.org/fred2/), but I always thought it would be neat to have the data available to be "pulled" as specified by inputting a few specific parameters. 

In the same vein, I wanted to build a visual companion for the [ECB statistical pocketbook](http://www.ecb.europa.eu/pub/pdf/stapobo/spb201403en.pdf) which basically displayed the same information in various types of graphs and charts. Again a fairly tedious project that I'm not really sure there's a huge demand for haha, but the pocketbook is released each month with updated versions of the same data, and you can export all the series for each table on the [statistical data warehouse](http://sdw.ecb.europa.eu/home.do) using their XML SDMX, it's just a question of visualization decisions, ensuring it doesn't break from month to month, and setting it up for 50+ tables. Again this is a pretty tedious process partly why I never got around to doing it. 
I have a problem that requires extensive use of array formulas...

Muahahahahaha
Create a customisable interface between two small-business accounting programs that facilitates pouring data from one into the other using *sendkeys.*
So I have a project I've been stuck on for quite a while, and if you want a challenge maybe you can try it out. 

Basically I need a way to assign meetings to people based on how they bid for them. A person will give their top five choices for scheduled meeting times, and they will be awarded in order of a few different criteria. Those with higher priority will be awarded their first choice until space runs out and then the people towards the bottom of the list will be awarded their 2nd 3rd 4th or 5th choice. 

I've been really struggling for a while to make a automated way of doing this. If I do it manually all the time and I'd love to find a way to automate it. Let me know if you think this is possible, I also thought about doing this in access but I don't have as much experience in SQL. 
Here's one I just thought of.  

Build a sheet that dynamically tracks the solutions proposed by /r/excel commenters and, in broad terms, reports the functions used in 'solved' problems.  You'll need:

* Some automated way of pulling /r/excel posts into a raw data sheet
* A worksheet that builds a running list of posts with assigned record identifiers.  This way, if posts are modified/deleted/expired and can no longer be pulled/etc., the sheet can account for these changes
* Some way of parsing post pieces, like title, description, commentary, and flair (i.e., to be able to filter out "discussion", "challenge", etc.)
* Custom functions/macros to search for keywords in the comments.  I would start with a *very* rudimentary search function -- say, searches for "INDEX" and/or "MATCH", "?LOOKUP", "SUMPRODUCT", "array", "VBA", etc.  You could easily spend a lot of time just developing this aspect of the sheet, so start small and simple. 
* Leverage the custom search functions/macros to categorize each post.  Possibly categorize titles/description as "requests" and categorize commentary separately as "solutions" 
* Build a dashboard to report the categorized results

For discussion: What percent of posts involve `*LOOKUP` or `INDEX` and/or `MATCH`?  If /u/BFG_9000 is to be believed, it's quite high.
I just have a quick question you may be able to handle. I have a worksheet of data. I'm trying to filter out all of the rows based on the first two characters. Essentially, I have a list of acceptable two character criteria, and I want to filer the worksheet by that list. I've tried the Advanced filter, and every time I do, it filters out everything in the list. Any ideas?
I have a problem with comparing two spreadsheets without using conditional formating. The biggest problem is the naming from my database and the comparable data source are always a little bit different. Small things like "ltd" and "Limited", "Mgt" and "Management". There is thousands of these entries I have to compare and its tedious.Let me know if that  makes sense. Thanks.
Need 5 individual users to be able to submit data to a master sheet.  Can't use a shared workbook because it would block people out if someone was in it.

Maybe a macro to open each workbook, copy & paste data,  close each workbook
Create a Data manipulation wizard. 

A1= "Storage upto 2 weeks in your own container"
==> Output as:

B1="2 weeks"
C1="Your own container"

I want this to be cross compatible. Basically 'If x, then do this.... if Y then do that". I need a data manipulator that takes in strings and extracts relevant data into other cells based on conditions. can you do this?
One thing I deal with is using freaking Kronos data :/.... It's only available in PDF form. Without a "good" conversion program you have to build text matching formulas to separate the data from the single column that it's dumped into when you drop it in excel. I'd like to see something that would search out all the unique values (spaces, ;, :, ect) in a PDF that's been dumped into a single column and place the data into separate cells within a row. I do this now for the reports I use (boss is too cheap to buy me a conversion tool) but it'd be nice to see one that could work in most any scenario.
just for you sports fans - heres a fun simulation of the current NCAA basketball tournament

https://drive.google.com/file/d/0ByUIUqLzGhwhVXJfSEJWTXctN28/edit?usp=sharing

to add to that: 

https://drive.google.com/file/d/0ByUIUqLzGhwheEZHd21ueml4em8/edit?usp=sharing

and, if you were to apply that model vs the betting odds in las vegas (the most efficient market for predicting games), heres how you would have done through the first 2 rounds of the tournament, using full kelly criterion betting strategy:

https://docs.google.com/file/d/0ByUIUqLzGhwha1ZvWDlhNnMtREE/edit
I too am a Financial Analyst funnily enough.

But my jobs is boring 75% of the year. Blergh.
This thread has been linked to from elsewhere on reddit.


 - [/r/ExcelPorn] [List of sheets I&#x27;ve made for people on /r/excel](http://np.reddit.com/r/ExcelPorn/comments/21u2bj/list_of_sheets_ive_made_for_people_on_rexcel/)


*^I ^am ^a ^bot. ^Comments? ^Complaints? [^Send ^them ^to ^my ^inbox!](http://www.reddit.com/message/compose/?to=totes_meta_bot)*


[deleted]
Hey sorry for the late follow up, but I was looking at your #1 on your list and the matching code doesn't include Names 1, 2, or 3 on the right side.  Is there a reason for that?
> I've automated myself out of employment twice

If that's true, consider it a blessing; those places were too [insert derogatory adjective] to keep you and pay for what your skills are worth.
... I've edited my original post.
xD
Depends what it is... I'm okay with arrays kinda.
There is always a way to do it efficiently bro!
Trying to afk and trick Lync I see...
I did something like that already, although I charge for that one :p
You monster.
I can take a shot at this. 

Do you have an example of how the end result looks?
I really like this idea - I can see an excelified index of posts/comments (questions/answers) against function names & kewords being really useful.  
  
In other news, vlookup is probably the answer...

Can't you use the left/right functions to get the first two characters in a helper column, then sort by that and hide the column when done? 
PM me with full details.
So you want to do comparisons, but you're not able to due to subtle changes?
You need to do standardisation my friend.
Are you able to provide a list of these subtleties?
You should look into fuzzy matching. Fuzzy matching algorithms could save you a lot of work with this kind of problem. There is even an  add-in already available from microsoft office's site for this kind of thing. [Fuzzy Lookup Add-In for Excel
](http://www.microsoft.com/en-us/download/details.aspx?id=15011) I haven't tried it, but it could be just the ticket. 

And here is a website showing how to use it. [k2e](http://www.k2e.com/tech-update/tips/431-tip-fuzzy-lookups-in-excel)
> A1= "Storage upto 2 weeks in your own container" ==> Output as:
> B1="2 weeks" C1="Your own container"

Quick and dirty:

    A1 =PROPER(MID($A$1,FIND("to ",$A$1)+3,8))
    B1 =PROPER(MID($A$1,FIND("your",$A$1),30))
How would you be bored when q1 is just around the corner.
Check out my edit brosef
Accounting software, Database software (SQL based)  
  
Generally I'll pull data from one or more systems and then analyse/present it in Excel


Sometimes ill have pasted the code when I think it works, notice a bug or find an improvement,  update the cell and forget the example code...  
  
Ill check if that is the case for 1 next time im at a pc
You know too much.

You must die >_>
*edit sorry for the novel but it takes some background info

Here’s a link to the before and after view:
https://drive.google.com/folderview?id=0B-nRZcqqlNp_cmRPX19PemVBcGM&usp=sharing

The goal is to award the classes that employees bid for in order of month their training is due and seniority number. Once they are all in the right order we can go down the list and assign their classes until each class is full, then if someone bids for that class we default to their next choice and so on. 

The starting point file is more or less how the info comes in. People send in a bid that gets sent to this spreadsheet. Each line represents one bid. The left most name and employee numbers identify who submitted the bid. When they bid they have to specify which 5 “REC#” they want in order or preference (they will only be awarded one).  Sometimes people will bid twice, so we always work off the latest bid received (delete the older ones). 

They also have a seniority number attached to them which will play a part in how they are awarded, the lower the seniority number the higher the priority- it’s like a rank (#1 goes first then #2 then #3 and so on all the way through #1700). One of the tricky things is that we have to rank them by month first. They have to come to training once a year, and can only train in a three month window from the last time they trained (one month before through one month after).
Example: If I trained in May of last year, this year I can only train in April, May, or June of this year. 



Priority goes to the people that are in their last month to train (Must go month).  In the above example, when awarding classes for May the priority goes to people in April, because if they don’t go in May they will fall out of their three month “window”.

So the hierarchy of awarding goes as follows:


1.	“Must Go Month” (In order of seniority)
THEN
2.	“Base Month” (In order of seniority)
THEN
3.	“Month Before Last Trained” (In order of seniority)


All that is the easy part. The hard part is buddy bidding. When people want to be assigned the same class session as their friends they buddy bid. At the end of the starting point file, you’ll see columns with “BB” in front of them. This is the employee # and seniority number of the buddies they want to attend training with. People can only buddy bid with two other people (biggest group can be 3 people) and all three people must bid the same (all five choices must be identical). They must list their buddy’s employee number in their bid, if they don’t match up, the buddy bid is not awarded and they are awarded as individuals. 
If the buddy bid is honored, everyone in that group drops to the priority of the lowest member of the group. (according to our sorting rules listed above.)
I usually make a “BBSeniority” column and a “BBAnniversary” column which is the anniversary month and seniority number of the lowest priority of the group. If the buddy bid is not awarded or the person bid individually, then I just copy and paste over their own seniority. Then we have the order they should all be assigned (the test award file). 


Then I go down the list and manually insert the employees into the classes until the class is full (22 slots each).  Which is shown in the Final file. 



I’m looking for the best possible way to automate this process. I know this is a lot and I don’t have very high expectations but if you can figure something out I’d be most appreciative. Thanks for taking a look!     

Ah, interesting. I'm fairly new to VBA, let me give that a go and see what happens.
Yes. How do I do the standardisation?.

>Are you able to provide a list of these subtleties?

Do you mean all the differences that are possible between the two sets of data?. If that is the case, no as its never a fixed set of things. I do investor targeting and from a database can mine thousands of institutional investors who have an interest in a particular space. Comparing that with lists done by a sell-side or even with our ownership is a bit tedious in terms of who is in each list.
how does this work? 
TIL about `PROPER`: the [MC Hammer](https://www.youtube.com/watch?v=DRz2-qrWIJA) of text functions.
Q1 reporting starts tomorrow through April until the database deadlines.

I have a lot of free time rest of the quarter, and I have no internal projects lined up.
I've just seen three of your projects.

I don't know why I'm even bothering, compared to your work I'll probably do a shit job!
So, the only think I'm missing right now is to autopopulate the class#, everything else I managed to (in a very very ugly way) do.

Give me a bit to get the list populate working
Just tried it. 
Put your data in B, in A1, put =left(B1,2), copy down then sort by the A values (just make sure to expand the selection).

Standardisation is where it looks at the information in the cells and changes it based on a given criteria.

You will need a list of all the changes you want to make however if you want to make it work - but the macro WILL be a bitch.
You could run a bunch of find/replaces on things like LTD, ltd, Limited to bring them all back to a common format...  
  
You could also convert all characters to caps with code etc... (I've done it with python for a hangman game, VBA would be able to as well)
Ignore `PROPER` for the moment; all that does is [text formatting](http://office.microsoft.com/en-us/excel-help/proper-function-HP010342805.aspx).  The real work is being done by `MID`, which returns the middle N characters of a string, and `FIND`, which looks in a string and returns the Nth character where your search string can be found.

The above functions work only if your data is formatted very specifically.  Namely, A1 above (actually -- it should be some other cell or you would get a circular reference) is looking for "to ", and returning the 8 characters after it, and B1 is looking for "your", and returning the 30 characters after it, including the four characters in "your".

If you have any other words, other than "weeks" or "own container", this will break.
Mate, you learn by doing and I wouldn't really want to classify any of the above as 'work' per say, it's all like one cool concept in a rough as guts layout lol...
  
Also you Mod this place, that's way more work than positing up solutions...
I've got a challenge for you, if you can figure out how to create a dynamic array without using volatile functions I'll tell you why it'll be useful...  
  
ie it should 'F9' to this:  
  
     {1,2,3,4,5,6,....,x}  
  
with x being a count/sum/input etc...  
  
I can do it using =ROW(INDIRECT("A1:A"&InputNumber)) but that is a volatile function and nails performance...
Thanks for giving it a shot, I'm sure what ever process you've got will help out the way I'm currently doing it. 
Any luck, my man? 
Looking at this: 

http://msdn.microsoft.com/en-us/library/ff700515(v=office.14).aspx

INDEX isn't a volatile function, so you could do something along these lines

A1:INDEX(A:A,inputnumber)

in a formula. 

I thought it wouldn't work, but was looking into possibly using CHOOSE to do something with, and the example in the help file is SUM(A2:CHOOSE(2,A3,A4,A5)) and it works.

Edit: I tested this formula: =SUMPRODUCT(A2:INDEX(A:A,C3,1),A5:A6) and it works fine
I actually really like that! tidy mate!  
  
I've got a couple of cool dynamic, dependant data validation sheets I'll post later using INDEX:INDEX in a named range

yeah me too, I was surprised it worked, will definitely come in handy in the future. 
